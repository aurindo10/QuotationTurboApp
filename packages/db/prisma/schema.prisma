// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
  previewFeatures = ["jsonProtocol"]
}

datasource db {
  provider = "postgresql"
  url = env("POSTGRES_PRISMA_URL") // uses connection pooling
  directUrl = env("POSTGRES_URL_NON_POOLING") // uses a direct connection
  shadowDatabaseUrl = env("POSTGRES_URL_NON_POOLING") // used for migrations
}
model Post {
    id      String @id @default(cuid())
    title   String
    content String
}

model Empresa {
  id   String @id @default(cuid())
  nome String
  apelido String
  cnpj String
  active Boolean? @default(true)
  createdAt DateTime? @default(now())
  whoCreated String
  updatedAt DateTime? @updatedAt
  linkOrders LinkOrders[]
  products Product[]
  Cotacoes Cotacoes[]
  Representante Representante[]
}

model LinkOrders {
  id  String @id @default(cuid())
  whoIsAsking String
  aproved Boolean? @default(false)
  createdAt DateTime? @default(now())
  empresaId String
  empresa Empresa @relation(fields: [empresaId], references: [id], onDelete: Cascade)
}
model Product {
  id  String @id @default(cuid())
  nome String
  descricao String
  brand String
  unit String
  whoCreated String
  createdAt DateTime? @default(now())
  updatedAt DateTime? @updatedAt
  empresaId String
  empresa Empresa @relation(fields: [empresaId], references: [id], onDelete: Cascade)
  ProdutosDaCotacao ProdutosDaCotacao[]
  code String?
}

model Cotacoes {
  id String @id @default(cuid())
  createdAt DateTime? @default(now())
  nome  String
  updatedAt DateTime? @updatedAt
  empresaId String
  empresa Empresa @relation(fields: [empresaId], references: [id], onDelete: Cascade)
  whoCreated String
  produtos ProdutosDaCotacao[]
  ammountOfTradeRepresentative Float?
  Representante Representante[]
  ProdutoCotado ProdutoCotado[]
  BuyList BuyList[]
}
model ProdutosDaCotacao {
  id String @id @default(cuid())
  createdAt DateTime? @default(now())
  updatedAt DateTime? @updatedAt
  cotacaoId String
  cotacao Cotacoes @relation(fields: [cotacaoId], references: [id], onDelete: Cascade)
  produtoId String
  produto Product @relation(fields: [produtoId], references: [id], onDelete: Cascade)
  whoCreated String
  empresaId String
  quantidade Float?
  code String?
  produtoCotado ProdutoCotado[]
}
model Representante {
  id String @id @default(cuid())
  nome String
  createdAt DateTime? @default(now())
  empresaId String
  empresa Empresa @relation(fields: [empresaId], references: [id], onDelete: Cascade)
  cotacaoId String
  cotacao Cotacoes @relation(fields: [cotacaoId], references: [id], onDelete: Cascade )
  produtoCotado ProdutoCotado[]
  empresaName String?
  buyList BuyList[]
}

model ProdutoCotado {
  id  String @id @default(cuid())
  createdAt DateTime? @default(now())
  cotacaoId String
  cotacao Cotacoes @relation(fields: [cotacaoId], references: [id], onDelete: Cascade)
  representanteId String
  representante Representante @relation(fields: [representanteId], references: [id], onDelete: Cascade)
  valor Float?
  produtoDaCotacaoId String
  produtoDaCotacao ProdutosDaCotacao @relation(fields: [produtoDaCotacaoId], references: [id], onDelete: Cascade)
  quantidadeMinima Float?
  code String?
  buyList BuyList[]
}

model BuyList {
  id String @id @default(cuid())
  createdAt DateTime? @default(now())
  produtoCotadoId String
  produtoCotado ProdutoCotado @relation(fields: [produtoCotadoId], references: [id], onDelete: Cascade)
  cotacaoId String?
  cotacao Cotacoes? @relation(fields: [cotacaoId], references: [id], onDelete: Cascade)
  representanteId String?
  representante Representante? @relation(fields: [representanteId], references: [id], onDelete: Cascade)
}